<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
</head>
<body>

<form name="upload">
    <input type="file" name="file">
    <input type="submit" value="Загрузить">
</form>

<form name="delete">
    <input type="text" name="file" placeholder="filename.ext">
    <input type="submit" value="Удалить">
</form>

<form name="download">
    <input type="text" name="file" placeholder="filename.ext">
    <input type="submit" value="Загрузить">
</form>

<script>
  'use strict';

//  document.forms.upload.onsubmit = function() {
//    const file = this.elements.file.files[0];
//
//    if (!file) return false;
//
//    const xhr = new XMLHttpRequest();
//    xhr.onload = xhr.onerror = function() {
//      if (this.status == 200) {
//        alert('success');
//      } else {
//        alert('error ' + this.status + ' ' + this.responseText);
//      }
//    };
//
//    xhr.open('POST', `/${file.name}`, true);
//    xhr.send(file);
//
//    return false;
//  };

  document.onsubmit = function(event) {
    event.preventDefault();

    const form = event.target;
    if (!form.file.value) return;

    //  /my/path/file.ext -> /file.ext
    const fileUrl = '/' + form.file.value.replace(/.*[\\\/]/, '');

    const xhr = new XMLHttpRequest();

    xhr.onload = xhr.onerror = function() {
      if (this.status == 200) {
        alert('success');
      } else {
        alert('error ' + this.status + ' ' + this.responseText);
      }
    };

    switch (event.target.name) {
      case 'upload':
        xhr.open('POST', fileUrl, true);
//        xhr.setRequestHeader('Content-Type', 'multipart/form-data');
        xhr.send(form.file.files[0]);
        break;

      case 'delete':
        xhr.open('DELETE', fileUrl, true);
        xhr.send();
        break;

      case 'download':
        xhr.open('GET', fileUrl, true);
        xhr.send();
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
            if(xhr.status == 200) {
              alert(xhr.responseText);
            }
          }
        };
        break;
    }

  };
</script>

</body>
</html>
